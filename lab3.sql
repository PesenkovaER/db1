
-- Заполнение таблицы client
INSERT INTO client (client_id, first_name, last_name, phone) VALUES
(1, 'Иван', 'Петров', '+79161234567'),
(2, 'Мария', 'Сидорова', '+79167654321'),
(3, 'Алексей', 'Козлов', '+79169998877'),
(4, 'Елена', 'Иванова', '+79161112233'),
(5, 'Дмитрий', 'Смирнов', '+79162223344'),
(6, 'Ольга', 'Кузнецова', '+79163334455'),
(7, 'Сергей', 'Попов', '+79164445566'),
(8, 'Анна', 'Васильева', '+79165556677'),
(9, 'Михаил', 'Петров', '+79166667788'),
(10, 'Наталья', 'Соколова', '+79167778899'),
(11, 'Андрей', 'Михайлов', '+79168889900'),
(12, 'Татьяна', 'Федорова', '+79169990011'),
(13, 'Павел', 'Морозов', '+79161001012'),
(14, 'Юлия', 'Волкова', '+79161112213'),
(15, 'Александр', 'Алексеев', '+79161223314'),
(16, 'Екатерина', 'Лебедева', '+79161334415'),
(17, 'Владимир', 'Семенов', '+79161445516'),
(18, 'Ирина', 'Егорова', '+79161556617'),
(19, 'Николай', 'Павлов', '+79161667718'),
(20, 'Марина', 'Степанова', '+79161778819'),
(21, 'Артем', 'Николаев', '+79161889920'),
(22, 'Светлана', 'Орлова', '+79161990021'),
(23, 'Роман', 'Андреев', '+79162001022'),
(24, 'Виктория', 'Макарова', '+79162112223'),
(25, 'Денис', 'Захаров', '+79162223324'),
(26, 'Анастасия', 'Зайцева', '+79162334425'),
(27, 'Максим', 'Соловьев', '+79162445526'),
(28, 'Кристина', 'Борисова', '+79162556627'),
(29, 'Игорь', 'Яковлев', '+79162667728'),
(30, 'Людмила', 'Григорьева', '+79162778829'),
(31, 'Станислав', 'Романов', '+79162889930'),
(32, 'Валентина', 'Воробьева', '+79162990031'),
(33, 'Юрий', 'Сергеев', '+79163001032'),
(34, 'Галина', 'Кузьмина', '+79163112233'),
(35, 'Виталий', 'Филиппов', '+79163223334'),
(36, 'Лариса', 'Комарова', '+79163334435'),
(37, 'Антон', 'Давыдов', '+79163445536'),
(38, 'Нина', 'Королева', '+79163556637'),
(39, 'Евгений', 'Жуков', '+79163667738'),
(40, 'Оксана', 'Ильина', '+79163778839'),
(41, 'Константин', 'Максимов', '+79163889940'),
(42, 'Вера', 'Полякова', '+79163990041'),
(43, 'Георгий', 'Васнецов', '+79164001042'),
(44, 'Зоя', 'Виноградова', '+79164112243'),
(45, 'Борис', 'Цветков', '+79164223344'),
(46, 'Раиса', 'Крылова', '+79164334445'),
(47, 'Валерий', 'Титов', '+79164445546'),
(48, 'Лидия', 'Карпова', '+79164556647'),
(49, 'Семен', 'Щербаков', '+79164667748'),
(50, 'Эльвира', 'Медведева', '+79164778849');

-- Заполнение таблицы tariff 
INSERT INTO tariff (tariff_id, tariff_name, cost_per_day, tariff_type) VALUES
(1, 'Городской', 1200.00, 'Эконом'),
(2, 'Комфорт-плюс', 2200.00, 'Комфорт'),
(3, 'Бизнес-класс', 3500.00, 'Бизнес'),
(4, 'Премиум-люкс', 4800.00, 'Бизнес'),
(5, 'Поминутный', 8.50, 'Эконом'),
(6, 'Суточный-комфорт', 1800.00, 'Комфорт'),
(7, 'Выходной-эконом', 1500.00, 'Эконом'),
(8, 'Корпоративный-бизнес', 3200.00, 'Бизнес'),
(9, 'Долгосрочный-эконом', 900.00, 'Эконом'),
(10, 'Семейный-комфорт', 2000.00, 'Комфорт');

-- Заполнение таблицы car 
INSERT INTO car (car_id, brand, model, license_plate) VALUES
(1, 'Hyundai', 'Solaris', 'А123ВС77'),
(2, 'Kia', 'Rio', 'В456ОР77'),
(3, 'Skoda', 'Octavia', 'С789ТУ77'),
(4, 'Lada', 'Vesta', 'Е321КХ77'),
(5, 'Toyota', 'Camry', 'У654ЛО77'),
(6, 'BMW', 'X3', 'Р987ФС77'),
(7, 'Volkswagen', 'Polo', 'Т159ЦВ77'),
(8, 'Renault', 'Duster', 'О753ШМ77'),
(9, 'Hyundai', 'Creta', 'П246НР77'),
(10, 'Kia', 'Sportage', 'Л852ДЕ77'),
(11, 'Ford', 'Focus', 'Х963ВН77'),
(12, 'Nissan', 'Qashqai', 'С741АК77'),
(13, 'Chevrolet', 'Aveo', 'М528ТР77'),
(14, 'Toyota', 'RAV4', 'Н369ФЛ77'),
(15, 'BMW', '5 Series', 'К258ЦП77'),
(16, 'Mercedes', 'C-Class', 'Е147ЩР77'),
(17, 'Audi', 'A4', 'У852БН77'),
(18, 'Volkswagen', 'Tiguan', 'П741ВК77'),
(19, 'Hyundai', 'Tucson', 'Л963МС77'),
(20, 'Kia', 'Optima', 'Р258ОТ77'),
(21, 'Skoda', 'Kodiaq', 'Т147ХЛ77'),
(22, 'Lada', 'Granta', 'Н852ЧП77'),
(23, 'Toyota', 'Corolla', 'Е369ЩМ77'),
(24, 'BMW', '3 Series', 'К741АР77'),
(25, 'Mercedes', 'E-Class', 'У258БК77'),
(26, 'Audi', 'A6', 'П963ЦН77'),
(27, 'Volkswagen', 'Passat', 'Л147ОЛ77'),
(28, 'Hyundai', 'Santa Fe', 'Р852ФТ77'),
(29, 'Kia', 'Sorento', 'Т369ХР77'),
(30, 'Ford', 'Mondeo', 'Н147ЧК77'),
(31, 'Nissan', 'X-Trail', 'Е852ЩН77'),
(32, 'Chevrolet', 'Cruze', 'К963АЛ77'),
(33, 'Toyota', 'Highlander', 'У147БР77'),
(34, 'BMW', 'X5', 'П258ЦК77'),
(35, 'Mercedes', 'GLC', 'Л852ОТ77'),
(36, 'Audi', 'Q5', 'Р369ФН77'),
(37, 'Volkswagen', 'Golf', 'Т852ХК77'),
(38, 'Hyundai', 'Elantra', 'Н147ЧР77'),
(39, 'Kia', 'Cerato', 'Е369ЩЛ77'),
(40, 'Skoda', 'Superb', 'К852АК77'),
(41, 'Lada', 'XRAY', 'У147БТ77'),
(42, 'Toyota', 'Land Cruiser', 'П258ЦР77'),
(43, 'BMW', '7 Series', 'Л963ОК77'),
(44, 'Mercedes', 'S-Class', 'Р147ФЛ77'),
(45, 'Audi', 'A8', 'Т852ХР77'),
(46, 'Volkswagen', 'Arteon', 'Н369ЧК77'),
(47, 'Hyundai', 'Sonata', 'Е852ЩТ77'),
(48, 'Kia', 'K5', 'К147АР77'),
(49, 'Ford', 'Kuga', 'У258БЛ77'),
(50, 'Nissan', 'Murano', 'П963ЦК77');

-- Заполнение таблицы driver_status 
INSERT INTO driver_status (status_id, client_id, has_license, category, experience, issue_date, expiry_date, license_number) VALUES
(1, 1, 'Y', 'B', 5, '2019-03-15', '2029-03-15', '77АВ123456'),
(2, 2, 'Y', 'B', 2, '2022-07-20', '2032-07-20', '77ОР654321'),
(3, 3, 'N', NULL, 0, NULL, NULL, NULL),
(4, 4, 'Y', 'BC', 8, '2016-05-10', '2026-05-10', '77КХ321789'),
(5, 5, 'Y', 'B', 3, '2021-09-25', '2031-09-25', '77ЛО654987'),
(6, 6, 'Y', 'B', 1, '2023-02-14', '2033-02-14', '77ФС159753'),
(7, 7, 'Y', 'BCD', 10, '2014-11-30', '2024-11-30', '77ЦВ486275'),
(8, 8, 'N', NULL, 0, NULL, NULL, NULL),
(9, 9, 'Y', 'B', 4, '2020-08-05', '2030-08-05', '77ШМ753951'),
(10, 10, 'Y', 'B', 6, '2018-12-20', '2028-12-20', '77НР258147'),
(11, 11, 'Y', 'B', 7, '2017-04-18', '2027-04-18', '77ВН369258'),
(12, 12, 'Y', 'B', 2, '2022-11-08', '2032-11-08', '77АК741852'),
(13, 13, 'Y', 'BC', 9, '2015-06-22', '2025-06-22', '77ТР528963'),
(14, 14, 'Y', 'B', 5, '2019-08-30', '2029-08-30', '77ФЛ147852'),
(15, 15, 'N', NULL, 0, NULL, NULL, NULL),
(16, 16, 'Y', 'B', 8, '2016-03-12', '2026-03-12', '77ЩР963741'),
(17, 17, 'Y', 'BCD', 12, '2012-09-25', '2022-09-25', '77БН258369'),
(18, 18, 'Y', 'B', 3, '2021-05-14', '2031-05-14', '77ВК654987'),
(19, 19, 'Y', 'B', 6, '2018-07-19', '2028-07-19', '77МС852741'),
(20, 20, 'N', NULL, 0, NULL, NULL, NULL),
(21, 21, 'Y', 'B', 4, '2020-01-22', '2030-01-22', '77ОТ147963'),
(22, 22, 'Y', 'BC', 11, '2013-12-05', '2023-12-05', '77ХЛ369258'),
(23, 23, 'Y', 'B', 2, '2022-08-17', '2032-08-17', '77ЧП741852'),
(24, 24, 'Y', 'B', 7, '2017-06-28', '2027-06-28', '77ЩМ963147'),
(25, 25, 'Y', 'BCD', 9, '2015-04-11', '2025-04-11', '77АР258741'),
(26, 26, 'N', NULL, 0, NULL, NULL, NULL),
(27, 27, 'Y', 'B', 5, '2019-10-03', '2029-10-03', '77БК654123'),
(28, 28, 'Y', 'B', 3, '2021-02-26', '2031-02-26', '77ЦН987321'),
(29, 29, 'Y', 'B', 8, '2016-11-15', '2026-11-15', '77ОЛ159753'),
(30, 30, 'Y', 'BC', 10, '2014-08-07', '2024-08-07', '77ФТ486279'),
(31, 31, 'Y', 'B', 4, '2020-05-19', '2030-05-19', '77ХР753159'),
(32, 32, 'N', NULL, 0, NULL, NULL, NULL),
(33, 33, 'Y', 'B', 6, '2018-03-24', '2028-03-24', '77ЧК258963'),
(34, 34, 'Y', 'B', 2, '2022-01-11', '2032-01-11', '77ЩН741258'),
(35, 35, 'Y', 'BCD', 13, '2011-07-30', '2021-07-30', '77АЛ369147'),
(36, 36, 'Y', 'B', 5, '2019-09-14', '2029-09-14', '77БР852963'),
(37, 37, 'Y', 'B', 7, '2017-12-08', '2027-12-08', '77ЦК147258'),
(38, 38, 'N', NULL, 0, NULL, NULL, NULL),
(39, 39, 'Y', 'B', 3, '2021-04-02', '2031-04-02', '77ОТ369741'),
(40, 40, 'Y', 'BC', 11, '2013-10-25', '2023-10-25', '77ФН852147'),
(41, 41, 'Y', 'B', 4, '2020-06-18', '2030-06-18', '77ХК963258'),
(42, 42, 'Y', 'B', 8, '2016-02-13', '2026-02-13', '77ЧР741369'),
(43, 43, 'Y', 'B', 6, '2018-08-29', '2028-08-29', '77ЩЛ258147'),
(44, 44, 'N', NULL, 0, NULL, NULL, NULL),
(45, 45, 'Y', 'BCD', 12, '2012-05-16', '2022-05-16', '77АК963852'),
(46, 46, 'Y', 'B', 5, '2019-11-07', '2029-11-07', '77БЛ147963'),
(47, 47, 'Y', 'B', 3, '2021-07-22', '2031-07-22', '77ЦР369258'),
(48, 48, 'Y', 'B', 9, '2015-01-14', '2025-01-14', '77ОК741147'),
(49, 49, 'Y', 'B', 7, '2017-03-09', '2027-03-09', '77ФЛ852369'),
(50, 50, 'N', NULL, 0, NULL, NULL, NULL);

-- Заполнение таблицы rental
INSERT INTO rental (contract_id, client_id, car_id, start_date, end_date, total_cost, status, tariff_id) VALUES
(1, 1, 15, '2024-01-15', '2024-01-20', 4500.00, 'ЗАВЕРШЕНА', 1),
(2, 2, 27, '2024-02-01', '2024-02-05', 8800.00, 'АКТИВНА', 2),
(3, 3, 8, '2024-03-10', '2024-03-15', 24000.00, 'ЗАВЕРШЕНА', 3),
(4, 4, 42, '2024-04-05', '2024-04-10', 3500.00, 'ПОДТВЕРЖДЕНА', 4),
(5, 5, 19, '2024-05-12', '2024-05-15', 8400.00, 'АКТИВНА', 5),
(6, 6, 33, '2024-06-20', '2024-06-25', 6000.00, 'ОЖИДАНИЕ_ПОДТВЕРЖДЕНИЯ', 6),
(7, 7, 11, '2024-07-03', '2024-07-10', 4200.00, 'ЗАВЕРШЕНА', 7),
(8, 8, 48, '2024-08-15', '2024-08-20', 11000.00, 'ОЖИДАНИЕ_ОПЛАТЫ', 8),
(9, 9, 22, '2024-09-01', '2024-09-07', 5400.00, 'ПОДТВЕРЖДЕНА', 9),
(10, 10, 5, '2024-10-10', '2024-10-15', 17500.00, 'АКТИВНА', 10),
(11, 11, 37, '2024-11-01', '2024-11-05', 6000.00, 'ПОДТВЕРЖДЕНА', 1),
(12, 12, 14, '2024-12-10', '2024-12-15', 7500.00, 'ОЖИДАНИЕ_ПОДТВЕРЖДЕНИЯ', 2),
(13, 13, 29, '2024-12-20', '2024-12-25', 9600.00, 'АКТИВНА', 3),
(14, 14, 3, '2024-01-25', '2024-01-30', 18000.00, 'ЗАВЕРШЕНА', 4),
(15, 15, 46, '2024-02-10', '2024-02-14', 22400.00, 'АКТИВНА', 5),
(16, 16, 21, '2024-03-05', '2024-03-12', 24500.00, 'ЗАВЕРШЕНА', 6),
(17, 17, 7, '2024-04-15', '2024-04-20', 13200.00, 'ПОДТВЕРЖДЕНА', 7),
(18, 18, 39, '2024-05-20', '2024-05-25', 9000.00, 'АКТИВНА', 8),
(19, 19, 25, '2024-06-08', '2024-06-15', 12600.00, 'ЗАВЕРШЕНА', 9),
(20, 20, 12, '2024-07-12', '2024-07-18', 20400.00, 'ОЖИДАНИЕ_ОПЛАТЫ', 10),
(21, 21, 44, '2024-08-22', '2024-08-28', 7200.00, 'ПОДТВЕРЖДЕНА', 1),
(22, 22, 18, '2024-09-05', '2024-09-10', 4250.00, 'АКТИВНА', 2),
(23, 23, 31, '2024-10-18', '2024-10-24', 10800.00, 'ЗАВЕРШЕНА', 3),
(24, 24, 9, '2024-11-11', '2024-11-16', 15300.00, 'ОЖИДАНИЕ_ПОДТВЕРЖДЕНИЯ', 4),
(25, 25, 50, '2024-12-03', '2024-12-09', 18900.00, 'АКТИВНА', 5),
(26, 26, 23, '2024-01-08', '2024-01-13', 8250.00, 'ЗАВЕРШЕНА', 6),
(27, 27, 38, '2024-02-14', '2024-02-19', 11600.00, 'ПОДТВЕРЖДЕНА', 7),
(28, 28, 16, '2024-03-21', '2024-03-27', 17100.00, 'АКТИВНА', 8),
(29, 29, 41, '2024-04-25', '2024-05-01', 19800.00, 'ЗАВЕРШЕНА', 9),
(30, 30, 28, '2024-05-30', '2024-06-05', 10500.00, 'ОЖИДАНИЕ_ОПЛАТЫ', 10),
(31, 31, 13, '2024-06-12', '2024-06-18', 14400.00, 'ПОДТВЕРЖДЕНА', 1),
(32, 32, 47, '2024-07-19', '2024-07-25', 7800.00, 'АКТИВНА', 2),
(33, 33, 6, '2024-08-24', '2024-08-30', 22500.00, 'ЗАВЕРШЕНА', 3),
(34, 34, 34, '2024-09-07', '2024-09-13', 16200.00, 'ОЖИДАНИЕ_ПОДТВЕРЖДЕНИЯ', 4),
(35, 35, 20, '2024-10-15', '2024-10-21', 19200.00, 'АКТИВНА', 5),
(36, 36, 45, '2024-11-20', '2024-11-26', 13500.00, 'ЗАВЕРШЕНА', 6),
(37, 37, 10, '2024-12-05', '2024-12-11', 16800.00, 'ПОДТВЕРЖДЕНА', 7),
(38, 38, 35, '2024-01-12', '2024-01-18', 11400.00, 'АКТИВНА', 8),
(39, 39, 2, '2024-02-17', '2024-02-23', 20700.00, 'ЗАВЕРШЕНА', 9),
(40, 40, 49, '2024-03-22', '2024-03-28', 12600.00, 'ОЖИДАНИЕ_ОПЛАТЫ', 10),
(41, 41, 24, '2024-04-28', '2024-05-04', 15300.00, 'ПОДТВЕРЖДЕНА', 1),
(42, 42, 17, '2024-05-05', '2024-05-11', 21600.00, 'АКТИВНА', 2),
(43, 43, 40, '2024-06-10', '2024-06-16', 9900.00, 'ЗАВЕРШЕНА', 3),
(44, 44, 1, '2024-07-15', '2024-07-21', 18300.00, 'ОЖИДАНИЕ_ПОДТВЕРЖДЕНИЯ', 4),
(45, 45, 36, '2024-08-20', '2024-08-26', 23400.00, 'АКТИВНА', 5),
(46, 46, 26, '2024-09-25', '2024-10-01', 14100.00, 'ЗАВЕРШЕНА', 6),
(47, 47, 43, '2024-10-30', '2024-11-05', 17700.00, 'ПОДТВЕРЖДЕНА', 7),
(48, 48, 30, '2024-11-08', '2024-11-14', 20100.00, 'АКТИВНА', 8),
(49, 49, 4, '2024-12-12', '2024-12-18', 12900.00, 'ЗАВЕРШЕНА', 9),
(50, 50, 32, '2024-12-24', '2024-12-30', 22200.00, 'ОЖИДАНИЕ_ОПЛАТЫ', 10);



-- Задание 1: Вывести список автомобилей, находящихся в аренде, с указанием ФИО клиента и даты возврата.

SELECT 
    c.brand,
    c.model,
    c.license_plate,
    cl.first_name,
    cl.last_name,
    r.end_date
FROM rental r
JOIN car c ON r.car_id = c.car_id
JOIN client cl ON r.client_id = cl.client_id
WHERE r.status = 'АКТИВНА';

-- Задание 2: Посчитать, сколько раз каждый автомобиль был в аренде.

SELECT 
    c.brand,
    c.model,
    c.license_plate,
    COUNT(r.contract_id) as rental_count
FROM car c
LEFT JOIN rental r ON c.car_id = r.car_id
GROUP BY c.car_id, c.brand, c.model, c.license_plate
ORDER BY rental_count DESC;

-- Задание 3: Вывести клиентов, чьи автомобили не арендовались более 6 месяцев.

SELECT 
    cl.client_id,
    cl.first_name,
    cl.last_name,
    c.brand,
    c.model,
    c.license_plate,
    MAX(r.end_date) as last_rental_date
FROM client cl
JOIN rental r ON cl.client_id = r.client_id
JOIN car c ON r.car_id = c.car_id
WHERE r.status = 'ЗАВЕРШЕНА'
GROUP BY cl.client_id, cl.first_name, cl.last_name, c.brand, c.model, c.license_plate
HAVING MAX(r.end_date) < DATE_SUB(CURDATE(), INTERVAL 6 MONTH)
ORDER BY last_rental_date ASC;